# slurm_parallelcluster_partitions.conf is managed by the pcluster processes.
# Do not modify.
# Please add user-specific slurm configuration options in slurm.conf
{% set has_static_nodes = namespace(has_static=false) -%}

ControlMachine={{ master_hostname }}
SuspendTime={{ scaling_config.scaledown_idletime }}

{% for queue in queues_config %}
include {{ queues_config[queue].queue_partition_filename }}
{%- for instance in queues_config[queue].instances -%}
{%- if instance.static_size > 0 -%}
{% set has_static_nodes.has_static = true %}
{%- endif -%}
{%- endfor -%}
{% endfor %}

{% if has_static_nodes.has_static -%}
SuspendExcNodes={%- for queue in queues_config -%}
{%- for instance in queues_config[queue].instances -%}
{%- if instance.static_size > 0 -%}
{{ queues_config[queue].queue_name }}-static-{{ instance.type }}[1-{{ instance.static_size }}]
{{- "," if not loop.last else "" -}}
{%- endif -%}
{% endfor %}
{% endfor %}
{% endif -%}
